# 近似文字列検索 (ADSB_GW)

近似文字列検索（編集距離3以内）を高速に行うプログラム群です。
100万件規模の文字列データベースに対して、高速な検索を実現します。

## ディレクトリ構成

```text
.
├── Makefile            # ビルド用
├── README.md           # 本ファイル
├── .gitignore          # Git除外設定
├── src/                # ソースコード
│   ├── prep_1.c        # 索引構築プログラム
│   ├── search_1.c      # 検索プログラム
│   ├── calc.c          # 検証用ハミング距離計算プログラム
│   └── analyze_queries.c 
└── test/               # テストデータ (Git管理外)
    ├── db.txt
    └── query.txt
```

## コンパイルと実行方法

以下の制約を守って実装されています。
*   コンパイルオプション: `-O2 -lm` のみ
*   並列化なし

### 1. ディレクトリ移動
ソースコードがあるディレクトリで作業します（推奨）。
※ またはルートでコンパイルし、パス指定で実行しても構いません。

```bash
cd src
```

### 2. コンパイル
```bash
gcc -O2 prep_1.c -o prep_1 -lm
gcc -O2 search_1.c -o search_1 -lm
gcc calc.c -o calc
```

### 3. 実行手順

計測は以下の手順で行います。`prep_1` でインデックス（索引）を作成し、`search_1` で検索を実行します。

**コマンド例:**
```bash
# 1. 索引構築 (標準出力を index_1 に保存)
./prep_1 ../test/db_1 > index_1

# 2. 検索実行 (標準出力を result_1 に保存)
./search_1 ../test/query_1 index_1 > result_1
```

### 4. 結果の検証 (自習用)
正解データ(`res_1` など)がある場合、`calc`コマンドで精度（ハミング距離）を確認できます。

```bash
# 正解データと比較
./calc ../test/res_1 result_1
```

## プログラム仕様
*   **prep_1**
    *   第一引数: DBデータファイル
    *   標準出力: 索引データ
*   **search_1**
    *   第一引数: クエリデータファイル
    *   第二引数: 索引データファイル
    *   標準出力: 結果ビットベクトル ("1" or "0" の羅列)

## アルゴリズム概要
*   **インデックス**: 文字列を4分割し、スライド(±1文字)させた状態もインデックスに登録することで、検索時のシフト処理を省略。
*   **フィルタリング**: 文字頻度ヒストグラムを用いたSWAR(SIMD Within A Register)的な高速フィルタ。
*   **詳細判定**: Myersのビット並列アルゴリズムを用いた厳密な編集距離計算。